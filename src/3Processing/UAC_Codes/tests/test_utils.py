#!/usr/bin/python3
#
import unittest
import numpy as np
from uac import utils


class TestUtils(unittest.TestCase):
    def test_find_index(self):
        ls = [1, 2, 3, 4, 5, 6, 7, 8, 9]
        self.assertEqual(utils.find_index(ls, min), 0)
        self.assertEqual(utils.find_index(ls, max), 8)

        ls = [5, 3, 9, 2, 6, 1, 0, 15, 30, 2, 5]
        self.assertEqual(utils.find_index(ls, min), 6)
        self.assertEqual(utils.find_index(ls, max), 8)

    def test_closest_node(self):
        pts = [None] * 2
        pts[0] = np.array(
            [
                [0.51648145, 0.69440869, 0.34709845],
                [0.19559794, 0.53375478, 0.05726996],
                [0.45218601, 0.17132774, 0.78958648],
                [0.09396233, 0.2746343, 0.02923586],
                [0.03994763, 0.90768708, 0.63845486],
                [0.67777585, 0.76647317, 0.12522392],
                [0.29955928, 0.43421349, 0.61227008],
                [0.5661832, 0.89258645, 0.77017734],
                [0.28991433, 0.62039734, 0.14650432],
                [0.77177826, 0.13079643, 0.88305269],
            ]
        )
        pts[1] = np.array(
            [
                [0.31361107, 0.57552084, 0.21327057],
                [0.51219306, 0.67445908, 0.00422607],
                [0.9425009, 0.6430541, 0.70032331],
                [0.94959759, 0.60773049, 0.021701],
                [0.37273665, 0.97833344, 0.70370212],
                [0.08702092, 0.93566025, 0.78472338],
                [0.63689083, 0.93909567, 0.68333101],
                [0.04387358, 0.25832743, 0.56253586],
                [0.46866503, 0.41597943, 0.24263204],
                [0.25294496, 0.56172141, 0.47298983],
            ]
        )
        np.testing.assert_almost_equal(
            utils.closest_node(pts[0], pts[1]),
            [
                0.07320061,
                0.12284382,
                0.47090236,
                0.84312154,
                0.11999664,
                0.81255519,
                0.37374825,
                0.71820683,
                0.08297903,
                0.62303588,
            ],
        )
